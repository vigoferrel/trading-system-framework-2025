<?xml version="1.0" encoding="utf-8" standalone="no"?>
<test-results xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="nunit_schema_2.5.xsd" name="Pester" total="9" errors="0" failures="0" not-run="0" inconclusive="0" ignored="0" skipped="0" invalid="0" date="2025-08-08" time="00:26:35">
  <environment clr-version="4.0.30319.42000" user-domain="DESKTOP-RMOB4H0" cwd="C:\Users\DELL\Desktop\QBTC-UNIFIED" platform="Microsoft Windows 10 Pro|C:\Windows|\Device\Harddisk0\Partition3" machine-name="DESKTOP-RMOB4H0" nunit-version="2.5.8.0" os-version="10.0.19045" user="DELL" />
  <culture-info current-culture="es-CL" current-uiculture="es-ES" />
  <test-suite type="TestFixture" name="Pester" executed="True" result="Success" success="True" time="0.8892" asserts="0" description="Pester">
    <results>
      <test-suite type="TestFixture" name="C:\Users\DELL\Desktop\QBTC-UNIFIED\tests\Detect-ApiKeyPermissions.Tests.ps1" executed="True" result="Success" success="True" time="0.8892" asserts="0" description="C:\Users\DELL\Desktop\QBTC-UNIFIED\tests\Detect-ApiKeyPermissions.Tests.ps1">
        <results>
          <test-suite type="TestFixture" name="Detect-ApiKeyPermissions" executed="True" result="Success" success="True" time="0.4759" asserts="0" description="Detect-ApiKeyPermissions">
            <results>
              <test-suite type="TestFixture" name="Detect-ApiKeyPermissions.Fully open key (no IP restrictions), Futures disabled" executed="True" result="Success" success="True" time="0.1633" asserts="0" description="Detect-ApiKeyPermissions.Fully open key (no IP restrictions), Futures disabled">
                <results>
                  <test-case description="detects open key, ip not evaluated, futures disabled" name="Detect-ApiKeyPermissions.Fully open key (no IP restrictions), Futures disabled.detects open key, ip not evaluated, futures disabled" time="0.1361" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="Detect-ApiKeyPermissions.Fully open key (restriction enabled but 0.0.0.0/0 present)" executed="True" result="Success" success="True" time="0.1757" asserts="0" description="Detect-ApiKeyPermissions.Fully open key (restriction enabled but 0.0.0.0/0 present)">
                <results>
                  <test-case description="treats as open key and sets IpAllowed true without checking client IP" name="Detect-ApiKeyPermissions.Fully open key (restriction enabled but 0.0.0.0/0 present).treats as open key and sets IpAllowed true without checking client IP" time="0.0075" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="Detect-ApiKeyPermissions.IP-restricted, client IP allowed" executed="True" result="Success" success="True" time="0.3921" asserts="0" description="Detect-ApiKeyPermissions.IP-restricted, client IP allowed">
                <results>
                  <test-case description="detects IP restriction and allows current IP" name="Detect-ApiKeyPermissions.IP-restricted, client IP allowed.detects IP restriction and allows current IP" time="0.2127" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="Detect-ApiKeyPermissions.IP-restricted, client IP NOT allowed" executed="True" result="Success" success="True" time="0.412" asserts="0" description="Detect-ApiKeyPermissions.IP-restricted, client IP NOT allowed">
                <results>
                  <test-case description="detects IP restriction and denies current IP" name="Detect-ApiKeyPermissions.IP-restricted, client IP NOT allowed.detects IP restriction and denies current IP" time="0.0145" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="Detect-ApiKeyPermissions.False-positive prevention: empty or malformed CIDR list" executed="True" result="Success" success="True" time="0.4399" asserts="0" description="Detect-ApiKeyPermissions.False-positive prevention: empty or malformed CIDR list">
                <results>
                  <test-case description="handles empty list as restriction enabled but no CIDRs (deny by default)" name="Detect-ApiKeyPermissions.False-positive prevention: empty or malformed CIDR list.handles empty list as restriction enabled but no CIDRs (deny by default)" time="0.0125" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="denies when CIDR is malformed" name="Detect-ApiKeyPermissions.False-positive prevention: empty or malformed CIDR list.denies when CIDR is malformed" time="0.0112" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="Detect-ApiKeyPermissions.Test-IpInCidr helper" executed="True" result="Success" success="True" time="0.461" asserts="0" description="Detect-ApiKeyPermissions.Test-IpInCidr helper">
                <results>
                  <test-case description="matches IP within /24" name="Detect-ApiKeyPermissions.Test-IpInCidr helper.matches IP within /24" time="0.0039" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="rejects IP outside /24" name="Detect-ApiKeyPermissions.Test-IpInCidr helper.rejects IP outside /24" time="0.0036" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="accepts 0.0.0.0/0 as universal" name="Detect-ApiKeyPermissions.Test-IpInCidr helper.accepts 0.0.0.0/0 as universal" time="0.0048" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
            </results>
          </test-suite>
        </results>
      </test-suite>
    </results>
  </test-suite>
</test-results>