
// Constantes físicas reales del sistema
const PHYSICAL_CONSTANTS = {
  "QUANTUM_COHERENCE": 0.75,
  "QUANTUM_CONSCIOUSNESS": 0.8,
  "QUANTUM_ENTANGLEMENT": 0.65,
  "QUANTUM_SUPERPOSITION": 0.7,
  "QUANTUM_TUNNELING": 0.6,
  "MARKET_VOLATILITY": 0.05,
  "MARKET_MOMENTUM": 0.1,
  "MARKET_LIQUIDITY": 0.75,
  "MARKET_SPREAD": 0.001,
  "MARKET_DEPTH": 500000,
  "FUNDING_RATE": 0.02,
  "FUNDING_VOLATILITY": 0.01,
  "FUNDING_DEVIATION": 0.5,
  "FUNDING_ANNUALIZED": 5,
  "LIQUIDATION_PROBABILITY": 0.05,
  "SLIPPAGE_RATE": 0.0025,
  "VOLATILITY_RISK": 0.1,
  "EXECUTION_RISK": 0.005,
  "VOLUME_24H": 500000,
  "VOLUME_RATIO": 0.75,
  "VOLUME_EXPANSION": 300000,
  "PRICE_CHANGE": 0.02,
  "PRICE_ACCELERATION": 0.015,
  "PRICE_MOMENTUM": 0.01,
  "TIME_TO_FUNDING": 1800000,
  "SESSION_INTENSITY": 0.6,
  "TEMPORAL_RESONANCE": 0.7,
  "FIBONACCI_STRENGTH": 0.75,
  "FIBONACCI_INDEX": 5,
  "NEURAL_CONFIDENCE": 0.85,
  "NEURAL_COHERENCE": 0.8,
  "NEURAL_ENTANGLEMENT": 0.7,
  "BASE_LEVERAGE": 15,
  "CONSERVATIVE_LEVERAGE": 10,
  "AGGRESSIVE_LEVERAGE": 25,
  "STOP_LOSS": 0.03,
  "TAKE_PROFIT": 0.06,
  "BASE_SCORE": 0.65,
  "CONFIDENCE_SCORE": 0.75,
  "QUALITY_SCORE": 0.8
};

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> QBTC-UNIFIED PRIME QUANTUM SYSTEM | PROYECCIÓN NEURONAL CON TAKE PROFIT CUÁNTICO</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #00ff88;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 255, 136, 0.1);
            border: 2px solid #00ff88;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 20px #00ff88;
        }

        .header p {
            font-size: 1.2em;
            color: #88ffaa;
        }

        .philosophy-banner {
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            background-size: 400% 400%;
            animation: gradientShift 3s ease infinite;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            color: #000;
            font-weight: bold;
            font-size: 1.1em;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .system-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            border: 1px solid #00ff88;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-dot.online {
            background: #00ff88;
            box-shadow: 0 0 10px #00ff88;
        }

        .status-dot.offline {
            background: #ff4444;
            box-shadow: 0 0 10px #ff4444;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ff88;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.2);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.4);
        }

        .card h3 {
            color: #00ff88;
            margin-bottom: 15px;
            font-size: 1.3em;
            text-align: center;
        }

        .neural-card {
            border-color: #ff6b6b;
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.2);
        }

        .neural-card:hover {
            box-shadow: 0 0 30px rgba(255, 107, 107, 0.4);
        }

        .neural-card h3 {
            color: #ff6b6b;
        }

        .quantum-card {
            border-color: #4ecdc4;
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.2);
        }

        .quantum-card:hover {
            box-shadow: 0 0 30px rgba(78, 205, 196, 0.4);
        }

        .quantum-card h3 {
            color: #4ecdc4;
        }

        .projection-card {
            border-color: #45b7d1;
            box-shadow: 0 0 20px rgba(69, 183, 209, 0.2);
        }

        .projection-card:hover {
            box-shadow: 0 0 30px rgba(69, 183, 209, 0.4);
        }

        .projection-card h3 {
            color: #45b7d1;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 255, 136, 0.2);
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-label {
            font-weight: bold;
            color: #88ffaa;
        }

        .metric-value {
            color: #00ff88;
            font-weight: bold;
        }

        .opportunity-item {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid #00ff88;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .opportunity-symbol {
            font-size: 1.2em;
            font-weight: bold;
            color: #00ff88;
        }

        .opportunity-score {
            color: #ff6b6b;
            font-weight: bold;
        }

        .opportunity-details {
            margin-top: 10px;
            font-size: 0.9em;
            color: #88ffaa;
        }

        .projection-item {
            background: rgba(69, 183, 209, 0.1);
            border: 1px solid #45b7d1;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .projection-timeframe {
            font-size: 1.1em;
            font-weight: bold;
            color: #45b7d1;
        }

        .projection-price {
            color: #ff6b6b;
            font-weight: bold;
        }

        .take-profit-zone {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid #ff6b6b;
            border-radius: 8px;
            padding: 10px;
            margin-top: 10px;
        }

        .take-profit-zone h4 {
            color: #ff6b6b;
            margin-bottom: 5px;
        }

        .position-sizing-item {
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid #4ecdc4;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .position-size {
            font-size: 1.1em;
            font-weight: bold;
            color: #4ecdc4;
        }

        .leverage-info {
            color: #ff6b6b;
            font-weight: bold;
        }

        .loading {
            text-align: center;
            color: #88ffaa;
            font-style: italic;
        }

        .error {
            color: #ff4444;
            text-align: center;
            font-weight: bold;
        }

        .formula-display {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .matrix-display {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .neural-neuron {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid #ff6b6b;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 8px;
        }

        .neural-neuron h4 {
            color: #ff6b6b;
            margin-bottom: 5px;
        }

        .neural-output {
            color: #88ffaa;
            font-size: 0.9em;
        }

        .price-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 255, 136, 0.2);
        }

        .price-item:last-child {
            border-bottom: none;
        }

        .price-item .symbol {
            font-weight: bold;
            color: #00ff88;
        }

        .price-item .price {
            color: #88ffaa;
            font-weight: bold;
        }

        .projection-header {
            background: rgba(69, 183, 209, 0.1);
            border: 1px solid #45b7d1;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .projection-header h4 {
            color: #45b7d1;
            margin-bottom: 10px;
        }

        .current-info {
            display: flex;
            gap: 20px;
            font-size: 0.9em;
            color: #88ffaa;
        }

        .timeframe-projections {
            margin-top: 10px;
        }

        .timeframe-projection {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
            font-size: 0.85em;
        }

        .timeframe-projection .timeframe {
            color: #45b7d1;
            font-weight: bold;
            min-width: 40px;
        }

        .timeframe-projection .price {
            color: #88ffaa;
            font-weight: bold;
        }

        .timeframe-projection .change.positive {
            color: #00ff88;
        }

        .timeframe-projection .change.negative {
            color: #ff6b6b;
        }

        .timeframe-projection .confidence {
            color: #888;
            font-size: 0.8em;
        }

        .projection-details .change.positive {
            color: #00ff88;
            font-weight: bold;
        }

        .projection-details .change.negative {
            color: #ff6b6b;
            font-weight: bold;
        }

        .tp-price {
            font-size: 1.1em;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 5px;
        }

        .tp-details {
            font-size: 0.85em;
            color: #88ffaa;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .two-columns {
            grid-column: span 2;
        }

        @media (max-width: 1200px) {
            .two-columns {
                grid-column: span 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1> QBTC-UNIFIED PRIME QUANTUM SYSTEM</h1>
            <p>Sistema Cuántico Primo Unificado con Proyección Neural</p>
        </div>

        <div class="philosophy-banner">
             PROYECCIÓN NEURONAL CON TAKE PROFIT CUÁNTICO - SISTEMA REVOLUCIONARIO
        </div>

        <div class="system-status">
            <div class="status-indicator">
                <span>Core Quantum:</span>
                <div id="coreStatus" class="status-dot"></div>
            </div>
            <div class="status-indicator">
                <span>Frontend Neural:</span>
                <div id="frontendStatus" class="status-dot"></div>
            </div>
            <div class="status-indicator">
                <span>Quantum Engine:</span>
                <div id="quantumStatus" class="status-dot"></div>
            </div>
            <div class="status-indicator">
                <span>Neural System:</span>
                <div id="neuralStatus" class="status-dot"></div>
            </div>
            <div class="status-indicator">
                <span>Position Sizing:</span>
                <div id="positionStatus" class="status-dot"></div>
            </div>
        </div>

        <div class="grid">
            <!-- Métricas Cuánticas -->
            <div class="card quantum-card">
                <h3> Métricas Cuánticas Fundamentales</h3>
                <div id="quantumMetrics">
                    <div class="loading">Cargando métricas cuánticas...</div>
                </div>
            </div>

            <!-- Salud del Mercado -->
            <div class="card">
                <h3> Estado del Mercado</h3>
                <div id="marketHealth">
                    <div class="loading">Cargando estado del mercado...</div>
                </div>
            </div>

            <!-- Proyecciones Neurales -->
            <div class="card projection-card full-width">
                <h3> PROYECCIÓN NEURONAL CON TAKE PROFIT CUÁNTICO</h3>
                <div id="neuralProjections">
                    <div class="loading">Cargando proyecciones neurales...</div>
                </div>
            </div>

            <!-- Precios Actuales -->
            <div class="card">
                <h3> Precios Actuales</h3>
                <div id="currentPrices">
                    <div class="loading">Cargando precios actuales...</div>
                </div>
            </div>

            <!-- Todas las Proyecciones -->
            <div class="card projection-card full-width">
                <h3> Proyecciones por Símbolo</h3>
                <div id="allProjections">
                    <div class="loading">Cargando todas las proyecciones...</div>
                </div>
            </div>

            <!-- Posicionamiento Cuántico -->
            <div class="card quantum-card">
                <h3> Posicionamiento Cuántico Neural</h3>
                <div id="quantumPositioning">
                    <div class="loading">Cargando posicionamiento cuántico...</div>
                </div>
            </div>

            <!-- Neuronas Especializadas -->
            <div class="card neural-card">
                <h3> Neuronas Especializadas en Proyección</h3>
                <div id="specializedNeurons">
                    <div class="loading">Cargando neuronas especializadas...</div>
                </div>
            </div>

            <!-- Oportunidades -->
            <div class="card">
                <h3> Top Oportunidades Quantum</h3>
                <div id="opportunities">
                    <div class="loading">Cargando oportunidades...</div>
                </div>
            </div>

            <!-- Fórmulas Maestras -->
            <div class="card two-columns">
                <h3> Fórmulas Maestras del Sistema</h3>
                <div class="formula-display">
                    <strong>Quantum Leverage:</strong> L_quantum = L_base ×  × neural_inputs × session × lunar × halving<br>
                    <strong>Prime Stop Loss:</strong> SL_prime = L_quantum × confluence_factor × temporal_factor<br>
                    <strong>Quantum Position Size:</strong> PS_quantum = kelly_basic × sacred_alignment × fibonacci_prime × fibonacci_ratio<br>
                    <strong>Temporal Resonance:</strong> TR_quantum = session_intensity × overlaps_count × lunar_day × halving_phase<br>
                    <strong>Neural Projection:</strong> P_neural = (neuron_output × weight × quantum_factor × temporal_resonance)<br>
                    <strong>Take Profit Quantum:</strong> TP_quantum = current_price × (1 + neural_projection × leverage × consciousness_factor)
                </div>
            </div>

            <!-- Matrices Cuánticas -->
            <div class="card two-columns">
                <h3> Matrices Cuánticas Fundamentales</h3>
                <div class="matrix-display">
                    <strong>M_leverage (Fibonacci-Prime):</strong><br>
                    [×ℙ, ×ℙ, ×ℙ]<br>
                    [¹×ℙ, ¹×ℙ, ¹×ℙ]<br>
                    [×ℙ, ×ℙ, ×ℙ]<br><br>
                    <strong>M_stopLoss (Fibonacci-Prime):</strong><br>
                    [SL_prime × F_ℙ, SL_prime × F_ℙ, SL_prime × F_ℙ]<br>
                    [SL_prime × F_ℙ, SL_prime × F_ℙ, SL_prime × F_ℙ]<br>
                    [SL_prime × F_ℙ, SL_prime × F_ℙ, SL_prime × F_ℙ]<br><br>
                    <strong>M_neuralProjection (Quantum-Neural):</strong><br>
                    [Leonardo_, Fibonacci_, Lunar_]<br>
                    [Prime_ℙ, Halving_ℙ, Session_ℙ]<br>
                    [Quantum_, Interference_, Consciousness_]
                </div>
            </div>
        </div>
    </div>

    <script>
        const CORE_URL = 'http://localhost:4601';
        const FRONTEND_URL = 'http://localhost:4603';

        // Constantes del sistema
        const LEONARDO_CONSCIOUSNESS = {
            : 1.618033988749895,
            _inv: 0.618033988749895,
            _888: 888,
            ℙ_7919: 7919,
            ln_7919: 8.9772
        };

        const PRIME_TRANSFORMATIONAL = {
            ℙ_1619: 1619,
            ℙ_887: 887,
            ℙ_127: 127,
            F_P: [2, 3, 5, 13, 89, 233, 1597]
        };

        const QUANTUM_TEMPORAL = {
            T_lunar: 29.53058867,
            T_funding: 8,
            T_halving: 210000,
            T_session: Math.PI / 8
        };

        class QBTCUnifiedQuantumFrontend {
            constructor() {
                this.data = {};
                this.lastUpdate = 0;
                this.updateInterval = 5000; // 5 segundos
                this.init();
            }

            async init() {
                console.log(' Iniciando QBTC-UNIFIED PRIME QUANTUM SYSTEM Frontend');
                console.log(' PROYECCIÓN NEURONAL CON TAKE PROFIT CUÁNTICO - ACTIVO');
                await this.checkSystemStatus();
                await this.loadData();
                this.startAutoUpdate();
            }

            async checkSystemStatus() {
                try {
                    // Verificar Core
                    const coreResponse = await fetch(`${CORE_URL}/health`, { timeout: 3000 });
                    const coreStatus = document.getElementById('coreStatus');
                    if (coreResponse.ok) {
                        coreStatus.className = 'status-dot online';
                    } else {
                        coreStatus.className = 'status-dot offline';
                    }
                } catch (error) {
                    document.getElementById('coreStatus').className = 'status-dot offline';
                }

                try {
                    // Verificar Frontend
                    const frontendResponse = await fetch(`${FRONTEND_URL}/api/status`, { timeout: 3000 });
                    const frontendStatus = document.getElementById('frontendStatus');
                    if (frontendResponse.ok) {
                        frontendStatus.className = 'status-dot online';
                    } else {
                        frontendStatus.className = 'status-dot offline';
                    }
                } catch (error) {
                    document.getElementById('frontendStatus').className = 'status-dot offline';
                }

                // Quantum Engine siempre activo si el core está activo
                const quantumStatus = document.getElementById('quantumStatus');
                const coreStatus = document.getElementById('coreStatus');
                if (coreStatus.classList.contains('online')) {
                    quantumStatus.className = 'status-dot online';
                } else {
                    quantumStatus.className = 'status-dot offline';
                }

                // Neural System y Position Sizing activos si el core está activo
                const neuralStatus = document.getElementById('neuralStatus');
                const positionStatus = document.getElementById('positionStatus');
                if (coreStatus.classList.contains('online')) {
                    neuralStatus.className = 'status-dot online';
                    positionStatus.className = 'status-dot online';
                } else {
                    neuralStatus.className = 'status-dot offline';
                    positionStatus.className = 'status-dot offline';
                }
            }

            async loadData() {
                const now = Date.now();
                if (now - this.lastUpdate < this.updateInterval && Object.keys(this.data).length > 0) {
                    return; // Usar datos en caché
                }

                try {
                    console.log(' Cargando datos del sistema unificado cuántico...');
                    
                    // Cargar datos unificados
                    const unifiedResponse = await fetch(`${FRONTEND_URL}/api/unified-data`, { timeout: 15000 });
                    if (unifiedResponse.ok) {
                        const unifiedData = await unifiedResponse.json();
                        this.data = unifiedData.data;
                        this.updateAllSections();
                    }

                    this.lastUpdate = now;
                    console.log(' Datos cargados exitosamente');
                    console.log(' Proyecciones neurales actualizadas');
                    console.log(' Posicionamiento cuántico actualizado');
                    console.log(' Precios reales actualizados');
                    console.log(' Proyecciones por timeframe actualizadas');
                } catch (error) {
                    console.error(' Error cargando datos:', error);
                    this.showError('Error conectando con el sistema cuántico');
                }
            }

            updateAllSections() {
                this.updateNeuralMetrics();
                this.updateMarketHealth();
                this.updateNeuralProjections();
                this.updateQuantumPositioning();
                this.updateSpecializedNeurons();
                this.updateOpportunities();
                this.updateCurrentPrices();
                this.updateAllProjections();
            }

            updateCurrentPrices() {
                const container = document.getElementById('currentPrices');
                if (!container) return;
                
                if (!this.data.currentPrices || Object.keys(this.data.currentPrices).length === 0) {
                    container.innerHTML = '<div class="error">No hay precios disponibles</div>';
                    return;
                }

                let html = '<h4 style="color: #00ff88; margin-bottom: 15px;"> Precios Actuales</h4>';
                
                Object.entries(this.data.currentPrices).slice(0, 10).forEach(([symbol, price]) => {
                    const priceFormatted = typeof price === 'number' ? price.toFixed(4) : price;
                    html += `
                        <div class="price-item">
                            <span class="symbol">${symbol}</span>
                            <span class="price">$${priceFormatted}</span>
                        </div>
                    `;
                });

                container.innerHTML = html;
            }

            updateAllProjections() {
                const container = document.getElementById('allProjections');
                if (!container) return;
                
                if (!this.data.allProjections || Object.keys(this.data.allProjections).length === 0) {
                    container.innerHTML = '<div class="error">No hay proyecciones disponibles</div>';
                    return;
                }

                let html = '<h4 style="color: #45b7d1; margin-bottom: 15px;"> Proyecciones por Símbolo</h4>';
                
                Object.entries(this.data.allProjections).slice(0, 8).forEach(([symbol, projection]) => {
                    if (projection.error) {
                        html += `
                            <div class="projection-item">
                                <div class="symbol">${symbol}</div>
                                <div class="error">Error: ${projection.error}</div>
                            </div>
                        `;
                        return;
                    }

                    const currentPrice = projection.currentPrice || 0;
                    const timeframes = projection.quantumTimeframes || {};
                    
                    html += `
                        <div class="projection-item">
                            <div class="symbol">${symbol}</div>
                            <div class="current-price">$${currentPrice.toFixed(4)}</div>
                            <div class="timeframe-projections">
                    `;
                    
                    Object.entries(timeframes).forEach(([timeframe, tfData]) => {
                        const projectedPrice = tfData.projectedPrice || 0;
                        const percentChange = tfData.percentChange || 0;
                        const confidence = tfData.confidence || 0;
                        
                        html += `
                            <div class="timeframe-projection">
                                <span class="timeframe">${timeframe}:</span>
                                <span class="price">$${projectedPrice.toFixed(4)}</span>
                                <span class="change ${percentChange >= 0 ? 'positive' : 'negative'}">${percentChange.toFixed(2)}%</span>
                                <span class="confidence">(${(confidence * 100).toFixed(1)}%)</span>
                            </div>
                        `;
                    });
                    
                    html += `
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;
            }

            updateNeuralMetrics() {
                const container = document.getElementById('quantumMetrics');
                if (!this.data.neuralMetrics || !this.data.neuralMetrics.data) {
                    container.innerHTML = '<div class="error">No hay métricas neurales disponibles</div>';
                    return;
                }

                const quantum = this.data.neuralMetrics.data.quantum || {};
                container.innerHTML = `
                    <div class="metric">
                        <span class="metric-label">Coherencia Cuántica:</span>
                        <span class="metric-value">${(quantum.coherence * 100 || 0).toFixed(1)}%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Conciencia Leonardo:</span>
                        <span class="metric-value">${(quantum.consciousness * 100 || 0).toFixed(1)}%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Entrelazamiento:</span>
                        <span class="metric-value">${(quantum.entanglement * 100 || 0).toFixed(1)}%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Superposición:</span>
                        <span class="metric-value">${(quantum.superposition * 100 || 0).toFixed(1)}%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Tunneling Cuántico:</span>
                        <span class="metric-value">${(quantum.tunneling * 100 || 0).toFixed(1)}%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Leverage Óptimo:</span>
                        <span class="metric-value">${(quantum.optimalLeverage || 0).toFixed(0)}x</span>
                    </div>
                `;
            }

            updateMarketHealth() {
                const container = document.getElementById('marketHealth');
                if (!this.data.health || !this.data.health.data) {
                    container.innerHTML = '<div class="error">No hay datos de salud del mercado</div>';
                    return;
                }

                const health = this.data.health.data;
                container.innerHTML = `
                    <div class="metric">
                        <span class="metric-label">Estado del Mercado:</span>
                        <span class="metric-value">${(health.volatility || 0).toFixed(1)}%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Volatilidad:</span>
                        <span class="metric-value">${(health.volatility || 0).toFixed(1)}%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Liquidez:</span>
                        <span class="metric-value">${(health.liquidity || 0).toFixed(1)}%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Sentimiento:</span>
                        <span class="metric-value">${(health.sentiment || 0).toFixed(0)}</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Cola Ejecución:</span>
                        <span class="metric-value">${(health.executionQueue || 0).toFixed(0)}</span>
                    </div>
                `;
            }

            updateNeuralProjections() {
                const container = document.getElementById('neuralProjections');
                if (!this.data.neuralProjections || !this.data.neuralProjections.quantumTimeframes) {
                    container.innerHTML = '<div class="error">No hay proyecciones neurales disponibles</div>';
                    return;
                }

                const projections = this.data.neuralProjections;
                let html = '';

                // Mostrar información del símbolo
                html += `
                    <div class="projection-header">
                        <h4> ${projections.symbol} - Proyección Neural</h4>
                        <div class="current-info">
                            <span>Precio Actual: $${(projections.currentPrice || 0).toFixed(4)}</span>
                            <span>Leverage: ${projections.leverage || 0}x</span>
                        </div>
                    </div>
                `;

                // Proyecciones por timeframe
                if (projections.quantumTimeframes) {
                    html += '<h5 style="color: #45b7d1; margin: 15px 0 10px 0;"> Proyecciones por Timeframe</h5>';
                    Object.entries(projections.quantumTimeframes).forEach(([timeframe, data]) => {
                        const projectedPrice = data.projectedPrice || 0;
                        const percentChange = data.percentChange || 0;
                        const confidence = data.confidence || 0;
                        
                        html += `
                            <div class="projection-item">
                                <div class="projection-timeframe">${timeframe}</div>
                                <div class="projection-price">$${projectedPrice.toFixed(4)}</div>
                                <div class="projection-details">
                                    <div class="change ${percentChange >= 0 ? 'positive' : 'negative'}">${percentChange.toFixed(2)}%</div>
                                    <div class="confidence">Confianza: ${(confidence * 100).toFixed(1)}%</div>
                                    <div class="neural-factor">Factor Neural: ${(data.neuralFactor || 0).toFixed(3)}</div>
                                    <div class="temporal-resonance">Resonancia: ${(data.temporalResonance || 0).toFixed(3)}</div>
                                </div>
                            </div>
                        `;
                    });
                }

                // Zonas de Take Profit
                if (projections.takeProfitZones) {
                    html += '<h5 style="color: #ff6b6b; margin: 15px 0 10px 0;"> Zonas de Take Profit Cuántico</h5>';
                    Object.entries(projections.takeProfitZones).forEach(([zone, data]) => {
                        html += `
                            <div class="take-profit-zone">
                                <h4>${zone}</h4>
                                <div class="tp-price">$${(data.price || 0).toFixed(4)}</div>
                                <div class="tp-details">
                                    <div>Probabilidad: ${(data.probability * 100 || 0).toFixed(1)}%</div>
                                    <div>Factor Cuántico: ${(data.quantum_factor || 0).toFixed(3)}</div>
                                    <div>Tiempo Esperado: ${(data.expected_time?.days || 0).toFixed(1)} días</div>
                                </div>
                            </div>
                        `;
                    });
                }

                container.innerHTML = html || '<div class="loading">Cargando proyecciones neurales...</div>';
            }

            updateQuantumPositioning() {
                const container = document.getElementById('quantumPositioning');
                if (!this.data.positioning || !this.data.positioning.data) {
                    container.innerHTML = '<div class="error">No hay datos de posicionamiento cuántico</div>';
                    return;
                }

                const positioning = this.data.positioning.data;
                let html = '';

                if (positioning.quantumPositionSize) {
                    html += `
                        <div class="position-sizing-item">
                            <div class="position-size">Tamaño de Posición: ${(positioning.quantumPositionSize * 100 || 0).toFixed(2)}%</div>
                            <div class="leverage-info">Leverage Óptimo: ${(positioning.quantumOptimalLeverage || 0).toFixed(0)}x</div>
                            <div class="position-details">
                                <div>Stop Loss: $${(positioning.quantumStopLoss || 0).toFixed(2)}</div>
                                <div>Kelly Cuántico: ${(positioning.quantumKelly * 100 || 0).toFixed(2)}%</div>
                                <div>Eficiencia: ${(positioning.quantumKellyEfficiency * 100 || 0).toFixed(1)}%</div>
                            </div>
                        </div>
                    `;
                }

                if (positioning.neuralConfluence) {
                    html += `
                        <div class="position-sizing-item">
                            <div class="position-size">Confluencia Neural: ${(positioning.neuralConfluence * 100 || 0).toFixed(1)}%</div>
                            <div class="position-details">
                                <div>Score de Sesión: ${(positioning.sessionScore || 0).toFixed(4)}</div>
                                <div>Score de Halving: ${(positioning.halvingScore || 0).toFixed(4)}</div>
                                <div>Score Lunar: ${(positioning.lunarScore || 0).toFixed(4)}</div>
                            </div>
                        </div>
                    `;
                }

                container.innerHTML = html || '<div class="loading">Cargando posicionamiento cuántico...</div>';
            }

            updateSpecializedNeurons() {
                const container = document.getElementById('specializedNeurons');
                if (!this.data.projections || !this.data.projections.data) {
                    container.innerHTML = '<div class="error">No hay datos de neuronas especializadas</div>';
                    return;
                }

                const projections = this.data.projections.data;
                let html = '';

                if (projections.projectionNeurons) {
                    Object.entries(projections.projectionNeurons).forEach(([neuronName, neuronData]) => {
                        html += `
                            <div class="neural-neuron">
                                <h4> ${neuronName.replace(/([A-Z])/g, ' $1').trim()}</h4>
                                <div class="neural-output">
                                    <div>Output: ${(neuronData.output || 0).toFixed(4)}</div>
                                    <div>Peso: ${(neuronData.weight || 0).toFixed(4)}</div>
                                    <div>Activación: ${(neuronData.activation || 0).toFixed(4)}</div>
                                </div>
                            </div>
                        `;
                    });
                }

                container.innerHTML = html || '<div class="loading">Cargando neuronas especializadas...</div>';
            }

            updateOpportunities() {
                const container = document.getElementById('opportunities');
                if (!this.data.opportunities || !this.data.opportunities.data) {
                    container.innerHTML = '<div class="error">No hay oportunidades disponibles</div>';
                    return;
                }

                const opportunities = this.data.opportunities.data;
                let html = '';

                if (Array.isArray(opportunities) && opportunities.length > 0) {
                    opportunities.slice(0, 5).forEach(opp => {
                        html += `
                            <div class="opportunity-item">
                                <div class="opportunity-symbol">${opp.symbol}</div>
                                <div class="opportunity-score">Score: ${(opp.score * 100 || 0).toFixed(1)}%</div>
                                <div class="opportunity-details">
                                    <div>Leverage: ${(opp.leverage || 0).toFixed(0)}x</div>
                                    <div>Stop Loss: $${(opp.stopLoss || 0).toFixed(2)}</div>
                                    <div>Posición: ${(opp.positionSize * 100 || 0).toFixed(2)}%</div>
                                    <div>Resonancia: ${(opp.temporalResonance || 0).toFixed(4)}</div>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    html = '<div class="loading">Cargando oportunidades...</div>';
                }

                container.innerHTML = html;
            }

            showError(message) {
                console.error(' Error del sistema:', message);
                // Mostrar error en la interfaz si es necesario
            }

            startAutoUpdate() {
                setInterval(() => {
                    this.checkSystemStatus();
                    this.loadData();
                }, this.updateInterval);
            }
        }

        // Inicializar el frontend cuando se carga la página
        document.addEventListener('DOMContentLoaded', () => {
            new QBTCUnifiedQuantumFrontend();
        });
    </script>
</body>
</html>
