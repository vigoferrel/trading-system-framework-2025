#!/usr/bin/env python3
"""
TEST MONITOR ASCII Ã“PTIMO - QBTC BANDA 46
==========================================
Script de prueba para mostrar la visualizaciÃ³n ASCII Ã³ptima del monitor expandido
"""

import requests
import json
import time
from datetime import datetime

def test_monitor_ascii_optimo():
    """Prueba la visualizaciÃ³n ASCII Ã³ptima del monitor."""
    base_url = "http://localhost:4606"
    
    print("ğŸ§ª TEST MONITOR ASCII Ã“PTIMO - QBTC BANDA 46")
    print("=" * 60)
    
    try:
        # 1. Probar constantes cuÃ¡nticas
        print("\n1ï¸âƒ£ PROBANDO CONSTANTES CUÃNTICAS...")
        response = requests.get(f"{base_url}/api/quantum-constants", timeout=5)
        if response.status_code == 200:
            data = response.json()
            constants = data['data']
            print("âœ… Constantes cuÃ¡nticas obtenidas:")
            print(f"   ğŸŒŠ Frecuencia Universal: {constants['universal_frequency']} Hz")
            print(f"   ğŸ”¬ Coherencia CuÃ¡ntica: {constants['quantum_coherence']:.2f}")
            print(f"   ğŸ§  Conciencia CuÃ¡ntica: {constants['quantum_consciousness']:.2f}")
            print(f"   ğŸ¯ Confianza Neural: {constants['neural_confidence']:.2f}")
            print(f"   ğŸ“Š Score Base: {constants['base_score']:.2f}")
            print(f"   ğŸ“ Log(7919): {constants['log_7919']:.4f}")
        else:
            print(f"âŒ Error: {response.status_code}")
    
    except Exception as e:
        print(f"âŒ Error en constantes cuÃ¡nticas: {e}")
    
    try:
        # 2. Probar visualizaciÃ³n ASCII Ã³ptima
        print("\n2ï¸âƒ£ PROBANDO VISUALIZACIÃ“N ASCII Ã“PTIMA...")
        response = requests.get(f"{base_url}/api/ascii-optimal-display", timeout=5)
        if response.status_code == 200:
            data = response.json()
            ascii_data = data['data']
            print("âœ… VisualizaciÃ³n ASCII obtenida:")
            print(f"   ğŸ§  DecisiÃ³n Neural: {ascii_data['neural_decision']}")
            print(f"   ğŸ¯ Confianza: {ascii_data['confidence']:.2f}%")
            print(f"   âš ï¸  Nivel de Riesgo: {ascii_data['risk_level']}")
            print(f"   â° Timeframe: {ascii_data['timeframe']}")
            print(f"   ğŸ§  Estado PsicolÃ³gico: {ascii_data['psychological_state']}")
            print(f"   ğŸ“Š Score Unificado: {ascii_data['unified_score']:.2f}")
            
            # Mostrar mÃ©tricas cuÃ¡nticas
            quantum = ascii_data['quantum_metrics']
            print(f"   ğŸŒŠ Fase CuÃ¡ntica: {quantum['phase']:.4f}")
            print(f"   ğŸ”¬ Magnitud CuÃ¡ntica: {quantum['magnitude']:.4f}")
            print(f"   ğŸ§  Mejora CuÃ¡ntica: {quantum['enhancement']:.4f}")
        else:
            print(f"âŒ Error: {response.status_code}")
    
    except Exception as e:
        print(f"âŒ Error en visualizaciÃ³n ASCII: {e}")
    
    try:
        # 3. Probar estado del stack neural
        print("\n3ï¸âƒ£ PROBANDO ESTADO DEL STACK NEURAL...")
        response = requests.get(f"{base_url}/api/neural-stack-status", timeout=5)
        if response.status_code == 200:
            data = response.json()
            stack_data = data['data']
            print("âœ… Estado del stack neural obtenido:")
            print(f"   ğŸ§  LLM Neural Orchestrator: {stack_data['llm_neural_orchestrator']}")
            print(f"   ğŸ”§ Estado del Sistema: {stack_data['system_health']}")
            
            # Mostrar servicios
            services = stack_data['services']
            print("   ğŸ“¡ Servicios:")
            for service, status in services.items():
                status_icon = "âœ…" if status == "ACTIVE" else "âŒ" if status == "OFFLINE" else "âš ï¸"
                print(f"      {status_icon} {service}: {status}")
        else:
            print(f"âŒ Error: {response.status_code}")
    
    except Exception as e:
        print(f"âŒ Error en stack neural: {e}")
    
    try:
        # 4. Probar decisiÃ³n unificada del LLM
        print("\n4ï¸âƒ£ PROBANDO DECISIÃ“N UNIFICADA DEL LLM...")
        response = requests.get(f"{base_url}/api/llm-unified-decision", timeout=10)
        if response.status_code == 200:
            data = response.json()
            llm_data = data['data']
            print("âœ… DecisiÃ³n unificada del LLM obtenida:")
            print(f"   ğŸ§  DecisiÃ³n: {llm_data.get('decision', 'N/A')}")
            print(f"   ğŸ¯ Confianza: {llm_data.get('confidence', 0):.2f}%")
            print(f"   âš ï¸  Nivel de Riesgo: {llm_data.get('risk_level', 'N/A')}")
            print(f"   â° Timeframe: {llm_data.get('timeframe', 'N/A')}")
            print(f"   ğŸ“ Razonamiento: {llm_data.get('reasoning', 'N/A')[:100]}...")
        else:
            print(f"âŒ Error: {response.status_code}")
    
    except Exception as e:
        print(f"âŒ Error en decisiÃ³n LLM: {e}")
    
    print("\n" + "=" * 60)
    print("ğŸ¯ TEST COMPLETADO - MONITOR ASCII Ã“PTIMO EXPANDIDO")
    print("=" * 60)

if __name__ == "__main__":
    test_monitor_ascii_optimo()
