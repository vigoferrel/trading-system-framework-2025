const axios = require('axios');

async function quickBrainVerification() {
    try {
        console.log('ðŸ§  VERIFICACIÃ“N RÃPIDA DEL QUANTUM BRAIN');
        console.log('=' .repeat(50));
        
        console.log('\nðŸ“¡ Conectando al endpoint (timeout: 15s)...');
        const response = await axios.get('http://localhost:4602/api/quantum-brain-analysis', {
            timeout: 15000 // 15 segundos timeout
        });
        
        if (response.data.success) {
            const { brainAnalysis, brainRecommendations, enhancedCoherence, totalSymbolsAnalyzed } = response.data;
            
            console.log('\n[OK] RESPUESTA EXITOSA');
            console.log('=' .repeat(30));
            
            // Verificar estructura bÃ¡sica
            console.log('\n[DATA] ESTRUCTURA DE DATOS:');
            console.log(`  â€¢ Brain Analysis keys: ${Object.keys(brainAnalysis).length}`);
            console.log(`  â€¢ Brain Recommendations: ${brainRecommendations.length}`);
            console.log(`  â€¢ Total Symbols Reported: ${totalSymbolsAnalyzed}`);
            console.log(`  â€¢ Global Coherence: ${enhancedCoherence.globalCoherence}`);
            
            // Verificar solo los primeros 3 sÃ­mbolos para datos reales
            const analysisSymbols = Object.keys(brainAnalysis);
            if (analysisSymbols.length > 0) {
                console.log('\n[SEARCH] VERIFICACIÃ“N DE DATOS REALES (primeros 3):');
                
                const sampleSymbols = analysisSymbols.slice(0, 3);
                let realDataCount = 0;
                
                sampleSymbols.forEach(symbol => {
                    const data = brainAnalysis[symbol];
                    const price = data.realPrice;
                    const volume = data.realVolume;
                    
                    // Verificar si los precios son realistas
                    const isRealisticPrice = price && price > 0.01 && price < 100000;
                    const isRealisticVolume = volume && volume > 0;
                    
                    console.log(`\n  ${symbol}:`);
                    console.log(`    â€¢ Precio: $${price?.toFixed(4) || 'N/A'} ${isRealisticPrice ? '[OK]' : '[ERROR]'}`);
                    console.log(`    â€¢ Volumen: ${volume?.toFixed(2) || 'N/A'} ${isRealisticVolume ? '[OK]' : '[ERROR]'}`);
                    
                    if (isRealisticPrice && isRealisticVolume) {
                        realDataCount++;
                    }
                });
                
                console.log(`\n[UP] DATOS REALES: ${realDataCount}/${sampleSymbols.length}`);
            }
            
            // Verificar recomendaciones
            if (brainRecommendations.length > 0) {
                console.log('\n[ENDPOINTS] VERIFICACIÃ“N DE RECOMENDACIONES (primeras 3):');
                
                const sampleRecs = brainRecommendations.slice(0, 3);
                let realisticRecs = 0;
                
                sampleRecs.forEach(rec => {
                    const entryPrice = rec.entryPrice;
                    const isRealistic = entryPrice && entryPrice > 0.01 && entryPrice < 100000;
                    
                    console.log(`\n  ${rec.symbol}:`);
                    console.log(`    â€¢ Entry: $${entryPrice?.toFixed(4) || 'N/A'} ${isRealistic ? '[OK]' : '[ERROR]'}`);
                    console.log(`    â€¢ Action: ${rec.action}`);
                    console.log(`    â€¢ Brain Score: ${rec.brainScore?.toFixed(2) || 'N/A'}%`);
                    
                    if (isRealistic) {
                        realisticRecs++;
                    }
                });
                
                console.log(`\n[UP] RECOMENDACIONES REALISTAS: ${realisticRecs}/${sampleRecs.length}`);
            }
            
            // Resumen final
            console.log('\n[LIST] RESUMEN RÃPIDO:');
            console.log('=' .repeat(30));
            console.log(`  â€¢ SÃ­mbolos analizados: ${analysisSymbols.length} [OK]`);
            console.log(`  â€¢ Recomendaciones: ${brainRecommendations.length} [OK]`);
            console.log(`  â€¢ Coherencia: ${enhancedCoherence.globalCoherence} [OK]`);
            
            if (analysisSymbols.length > 0 && brainRecommendations.length > 0) {
                console.log('\nðŸŽ‰ Â¡VERIFICACIÃ“N EXITOSA!');
                console.log('[OK] Quantum Brain funcionando con datos reales');
            } else {
                console.log('\n[WARNING]  Problemas detectados');
            }
            
        } else {
            console.error('[ERROR] Error en la respuesta:', response.data.error);
        }
        
    } catch (error) {
        console.error('[ERROR] Error:', error.message);
        if (error.code === 'ECONNABORTED') {
            console.error('ðŸ’¡ Timeout - el endpoint estÃ¡ tardando mucho');
            console.error('ðŸ’¡ Esto puede ser normal si estÃ¡ analizando muchos sÃ­mbolos');
        }
    }
}

quickBrainVerification();
